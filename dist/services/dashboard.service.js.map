{"version":3,"sources":["../../src/services/dashboard.service.ts"],"sourcesContent":["import { Service } from \"typedi\";\nimport { PrismaClient } from \"@prisma/client\";\nimport { Application } from \"@/interfaces/dashboard.interface\";\nimport { CreateAndUpdateApplicationDto } from \"@/dtos/dashboard.dto\";\nimport { randomBytes } from \"crypto\";\nimport { HttpException } from \"@/exceptions/HttpException\";\n\n@Service()\nexport class DashboardService {\n    public app = new PrismaClient().application;\n\n    public async getApplications(userId: number): Promise<Application[]> {\n        const application: Application[] = await this.app.findMany({\n            where: {\n                creatorId: userId\n            }\n        })\n        return application;\n    }\n\n    public async createApplication(data: CreateAndUpdateApplicationDto, userId: number) {\n        const findApplication: Application = await this.app.findFirst({\n            where:{\n                name: data.name,\n                creatorId: userId\n            }\n        });\n        if (findApplication) throw new HttpException(409, `This application ${data.name} already exists`);\n        const clientSecret = randomBytes(32).toString(\"hex\");\n        const createApplication: Application = await this.app.create({\n            data: {\n                ...data,\n                creatorId: userId,\n                clientSecret\n            }\n        })\n        return createApplication\n    }\n\n    public async updateApplication(data:CreateAndUpdateApplicationDto , id:number){\n        const application: Application = await this.app.findUnique({\n            where:{\n                id\n            }\n        })\n        if (!application) throw new HttpException(400, \"Application doesn't exist\");\n        const updateApplication: Application = await this.app.update({\n            where:{\n                id\n            },\n            data:{\n                ...data\n            }\n        })\n        return updateApplication\n    }\n\n    public async deleteApplication(id:number) {\n        const application: Application = await this.app.findUnique({\n            where:{\n                id\n            }\n        })\n        if (!application) throw new HttpException(400, \"Application doesn't exist\");\n        const deletedApplicationData: Application = await this.app.delete({\n            where:{\n                id\n            }\n        })\n        return deletedApplicationData\n    }\n\n    public async deleteAll(){\n        const deletedApplicationsData = await this.app.deleteMany();\n        return deletedApplicationsData\n    }\n}"],"names":["DashboardService","getApplications","userId","application","app","findMany","where","creatorId","createApplication","data","findApplication","findFirst","name","HttpException","clientSecret","randomBytes","toString","create","updateApplication","id","findUnique","update","deleteApplication","deletedApplicationData","delete","deleteAll","deletedApplicationsData","deleteMany","PrismaClient","Service"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAQaA;;;eAAAA;;;wBARW;wBACK;wBAGD;+BACE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGvB,IAAA,AAAMA,mBAAN,MAAMA;IAGT,MAAaC,gBAAgBC,MAAc,EAA0B;QACjE,MAAMC,cAA6B,MAAM,IAAI,CAACC,GAAG,CAACC,QAAQ,CAAC;YACvDC,OAAO;gBACHC,WAAWL;YACf;QACJ;QACA,OAAOC;IACX;IAEA,MAAaK,kBAAkBC,IAAmC,EAAEP,MAAc,EAAE;QAChF,MAAMQ,kBAA+B,MAAM,IAAI,CAACN,GAAG,CAACO,SAAS,CAAC;YAC1DL,OAAM;gBACFM,MAAMH,KAAKG,IAAI;gBACfL,WAAWL;YACf;QACJ;QACA,IAAIQ,iBAAiB,MAAM,IAAIG,4BAAa,CAAC,KAAK,CAAC,iBAAiB,EAAEJ,KAAKG,IAAI,CAAC,eAAe,CAAC;QAChG,MAAME,eAAeC,IAAAA,mBAAW,EAAC,IAAIC,QAAQ,CAAC;QAC9C,MAAMR,oBAAiC,MAAM,IAAI,CAACJ,GAAG,CAACa,MAAM,CAAC;YACzDR,MAAM,wCACCA;gBACHF,WAAWL;gBACXY;;QAER;QACA,OAAON;IACX;IAEA,MAAaU,kBAAkBT,IAAkC,EAAGU,EAAS,EAAC;QAC1E,MAAMhB,cAA2B,MAAM,IAAI,CAACC,GAAG,CAACgB,UAAU,CAAC;YACvDd,OAAM;gBACFa;YACJ;QACJ;QACA,IAAI,CAAChB,aAAa,MAAM,IAAIU,4BAAa,CAAC,KAAK;QAC/C,MAAMK,oBAAiC,MAAM,IAAI,CAACd,GAAG,CAACiB,MAAM,CAAC;YACzDf,OAAM;gBACFa;YACJ;YACAV,MAAK,mBACEA;QAEX;QACA,OAAOS;IACX;IAEA,MAAaI,kBAAkBH,EAAS,EAAE;QACtC,MAAMhB,cAA2B,MAAM,IAAI,CAACC,GAAG,CAACgB,UAAU,CAAC;YACvDd,OAAM;gBACFa;YACJ;QACJ;QACA,IAAI,CAAChB,aAAa,MAAM,IAAIU,4BAAa,CAAC,KAAK;QAC/C,MAAMU,yBAAsC,MAAM,IAAI,CAACnB,GAAG,CAACoB,MAAM,CAAC;YAC9DlB,OAAM;gBACFa;YACJ;QACJ;QACA,OAAOI;IACX;IAEA,MAAaE,YAAW;QACpB,MAAMC,0BAA0B,MAAM,IAAI,CAACtB,GAAG,CAACuB,UAAU;QACzD,OAAOD;IACX;;QAlEA,uBAAOtB,OAAM,IAAIwB,oBAAY,GAAGzB,WAAW;;AAmE/C;AApEaH;IADZ6B,IAAAA,eAAO;GACK7B"}